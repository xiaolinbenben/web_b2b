(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2632],{92013:function(e,s,a){Promise.resolve().then(a.bind(a,56421))},56421:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return y}});var r=a(57437),t=a(2265),l=a(34755),i=a(30245);a(19827);var n=a(93142),d=a(27502),c=a(54534),o=a(48651),x=a(79525),p=a(11679),u=a(68575),h=a(7065),m=a(16836),w=a(93834),j=a(23496),f=a(96257),v=e=>{let{isOpen:s,onRequestClose:a,initialItem:l}=e,[n,d]=(0,t.useState)(l||{}),[p,u]=(0,t.useState)(!1);(0,t.useEffect)(()=>{d(l||{}),d(e=>({...e,password:""}))},[l]);let v=(e,s)=>{d(a=>({...a,[e]:s}))},g=(e,s)=>{d(a=>({...a,[e]:s}))},Z=async()=>{try{let e=new FormData;n.id&&e.append("id",n.id),n.username||c.ZP.error("用户名不能为空"),n.password||c.ZP.error("密码不能为空"),n.role||c.ZP.error("角色不能为空"),e.append("username",n.username||""),e.append("password",n.password||""),e.append("role",n.role||""),u(!0);let{code:s,msg:r,data:t}=await i.Z.post("/myapp/admin/user/create",e);0===s?(c.ZP.success("操作成功"),a(!0)):c.ZP.error(r||"网络异常"),u(!1)}catch(e){u(!1)}};return(0,r.jsx)(h.Z,{title:"新增",centered:!0,open:s,onCancel:()=>a(!1),footer:null,width:600,children:(0,r.jsx)(o.Z,{spinning:p,tip:"",children:(0,r.jsx)("div",{className:"flex flex-col",children:(0,r.jsx)("div",{className:"",children:(0,r.jsxs)("div",{className:"",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4 pt-4 pb-0",children:[(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,r.jsx)(f.Z,{title:"用户名",required:!0}),(0,r.jsx)(m.Z,{placeholder:"请输入",value:n.username,onChange:e=>v("username",e.target.value),style:{width:400}})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,r.jsx)(f.Z,{title:"密码",required:!0}),(0,r.jsx)(m.Z.Password,{placeholder:"请输入",value:n.password,onChange:e=>v("password",e.target.value),style:{width:400}})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,r.jsx)(f.Z,{title:"角色",required:!0}),(0,r.jsx)(w.Z,{placeholder:"请选择角色",value:n.role,style:{width:200},onChange:e=>g("role",e),options:[{value:"1",label:"管理员"},{value:"3",label:"演示员"}]})]})]}),(0,r.jsx)(j.Z,{}),(0,r.jsxs)("div",{className:"flex flex-row gap-4 justify-start",children:[(0,r.jsx)(x.ZP,{type:"primary",onClick:Z,children:"提交"}),(0,r.jsx)(x.ZP,{onClick:()=>a(!1),children:"取消"})]})]})})})})})},g=e=>{let{isOpen:s,onRequestClose:a,initialItem:l}=e,[n,d]=(0,t.useState)(l||{}),[p,u]=(0,t.useState)(!1);(0,t.useEffect)(()=>{d(l||{}),d(e=>({...e,password:""}))},[l]);let w=(e,s)=>{d(a=>({...a,[e]:s}))},v=async()=>{try{let e=new FormData;if(n.id&&e.append("id",n.id),!n.password||!n.newPassword1||!n.newPassword2){c.ZP.error("不能为空");return}e.append("password",n.password||""),e.append("newPassword1",n.newPassword1||""),e.append("newPassword2",n.newPassword2||""),u(!0);let{code:s,msg:r,data:t}=await i.Z.post("/myapp/admin/user/updatePwd",e);0===s?(c.ZP.success("操作成功"),a(!0)):c.ZP.error(r||"网络异常"),u(!1)}catch(e){u(!1)}};return(0,r.jsx)(h.Z,{title:"修改密码",centered:!0,open:s,onCancel:()=>a(!1),footer:null,width:600,children:(0,r.jsx)(o.Z,{spinning:p,tip:"",children:(0,r.jsx)("div",{className:"flex flex-col",children:(0,r.jsx)("div",{className:"",children:(0,r.jsxs)("div",{className:"",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4 pt-4 pb-0",children:[(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,r.jsx)(f.Z,{title:"用户名",required:!0}),(0,r.jsx)(m.Z,{placeholder:"请输入",value:n.username,disabled:!0,onChange:e=>w("username",e.target.value),style:{width:400}})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,r.jsx)(f.Z,{title:"原密码",required:!0}),(0,r.jsx)(m.Z.Password,{placeholder:"请输入",value:n.password,onChange:e=>w("password",e.target.value),style:{width:400}})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,r.jsx)(f.Z,{title:"新密码",required:!0}),(0,r.jsx)(m.Z.Password,{placeholder:"请输入",value:n.newPassword1,onChange:e=>w("newPassword1",e.target.value),style:{width:400}})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,r.jsx)(f.Z,{title:"确认密码",required:!0}),(0,r.jsx)(m.Z.Password,{placeholder:"请输入",value:n.newPassword2,onChange:e=>w("newPassword2",e.target.value),style:{width:400}})]})]}),(0,r.jsx)(j.Z,{}),(0,r.jsxs)("div",{className:"flex flex-row gap-4 justify-start",children:[(0,r.jsx)(x.ZP,{type:"primary",onClick:v,children:"提交"}),(0,r.jsx)(x.ZP,{onClick:()=>a(!1),children:"取消"})]})]})})})})})};function Z(){(0,u.v9)(e=>e.adminSetting),(0,u.I0)();let[e,s]=(0,t.useState)(!1),a=async()=>{try{s(!0);let{code:e,data:a}=await i.Z.get("/myapp/admin/user/list");0===e?h(a):c.ZP.error("数据获取失败"),s(!1)}catch(e){}};(0,t.useEffect)(()=>{a()},[]);let[l,h]=(0,t.useState)([]),[m,w]=(0,t.useState)(!1),[j,f]=(0,t.useState)(!1),[Z,y]=(0,t.useState)(null),P=e=>{w(!0),y(e)},N=e=>{f(!0),y(e)},C=async e=>{try{let{code:s,msg:r,data:t}=await i.Z.post("/myapp/admin/user/delete",{id:e.id});0===s?(c.ZP.success("删除成功"),a()):c.ZP.error(r||"删除失败")}catch(e){}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"bg-white",children:(0,r.jsx)("div",{children:(0,r.jsx)(o.Z,{spinning:e,tip:"",children:(0,r.jsxs)("div",{className:"px-4 py-4 flex flex-col gap-4",children:[(0,r.jsx)("div",{className:"flex flex-row gap-4",children:(0,r.jsx)(x.ZP,{type:"primary",onClick:()=>P({sort:0}),children:"新增"})}),(0,r.jsx)(p.Z,{columns:[{title:"ID",dataIndex:"id",key:"id",width:"90px",textWrap:"word-break",ellipsis:!0,render:e=>(0,r.jsx)("div",{children:e})},{title:"账号",dataIndex:"username",key:"username",width:"220px",textWrap:"word-break",ellipsis:!0},{title:"角色",dataIndex:"role",key:"role",render:e=>(0,r.jsx)("div",{children:"1"===e?"管理员":"演示账号"})},{title:"操作",key:"action",fixed:"right",align:"center",width:"180px",textWrap:"word-break",ellipsis:!0,render:(e,s)=>(0,r.jsxs)(n.Z,{size:"middle",children:[(0,r.jsx)("a",{className:"text-adminPrimaryColor",onClick:()=>N(s),children:"修改密码"}),(0,r.jsx)(d.Z,{title:"确定删除？",okText:"确定",cancelText:"取消",onConfirm:()=>C(s),children:(0,r.jsx)("a",{className:"text-adminPrimaryColor",children:"删除"})})]})}],dataSource:l,size:"middle",rowKey:e=>e.id,pagination:!1})]})})})}),(0,r.jsx)(v,{isOpen:m,onRequestClose:e=>{w(!1),y(null),e&&a()},initialItem:Z}),(0,r.jsx)(g,{isOpen:j,onRequestClose:e=>{f(!1),y(null),e&&a()},initialItem:Z})]})}function y(){let e=[{key:"1",label:"账号管理",children:(0,r.jsx)(Z,{})}];return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"bg-gray-100 px-4 py-4",children:(0,r.jsx)("div",{className:"",children:(0,r.jsx)(l.Z,{indicator:{size:e=>24,align:"center"},tabBarStyle:{paddingLeft:"20px",outline:"none",fontWeight:"400"},className:"bg-white custom-tab",defaultActiveKey:"1",items:e,onChange:e=>{}})})})})}},19827:function(e,s,a){"use strict";a(57437),a(2265),a(96257),a(30245);var r=a(30166);a(40257),(0,r.default)(()=>Promise.all([a.e(9766),a.e(4070),a.e(7320)]).then(a.bind(a,57320)),{loadableGenerated:{webpack:()=>[57320]},ssr:!1})},96257:function(e,s,a){"use strict";var r=a(57437);a(2265),s.Z=e=>{let{title:s,required:a,labelWidth:t=80}=e;return(0,r.jsxs)("span",{className:"text-[14px] text-[#777] h-[30px] leading-[30px] flex flex-row items-center",style:{width:"".concat(t,"px")},children:[(0,r.jsxs)("div",{children:[s," "]}),(0,r.jsx)("div",{className:"flex flex-col items-center mx-1",children:a?(0,r.jsx)("span",{className:"text-red-500 font-bold text-[14px] ",children:"*"}):null})]})}},30245:function(e,s,a){"use strict";var r=a(83464),t=a(40257);let l=r.Z.create({baseURL:t.env.NEXT_PUBLIC_BASE_URL,timeout:15e3,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{{let s=localStorage.getItem("admintoken");e.headers.ADMINTOKEN=s||""}return e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e.data,e=>{let{response:s}=e;if(s){if(401===s.status||403===s.status){localStorage.removeItem("admintoken"),localStorage.removeItem("username");let e=t.env.NEXT_PUBLIC_BASE_PATH||"";window.location.href=e+"/adminLogin"}return Promise.reject(s.data)}return Promise.reject(e)}),s.Z=l}},function(e){e.O(0,[3718,3464,2601,6382,4534,114,5821,1102,8575,8696,6836,3705,6399,2631,1581,2971,2117,1744],function(){return e(e.s=92013)}),_N_E=e.O()}]);