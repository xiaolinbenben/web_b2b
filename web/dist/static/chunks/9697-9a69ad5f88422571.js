"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9697],{96257:function(e,t,s){var l=s(57437);s(2265),t.Z=e=>{let{title:t,required:s,labelWidth:a=80}=e;return(0,l.jsxs)("span",{className:"text-[14px] text-[#777] h-[30px] leading-[30px] flex flex-row items-center",style:{width:"".concat(a,"px")},children:[(0,l.jsxs)("div",{children:[t," "]}),(0,l.jsx)("div",{className:"flex flex-col items-center mx-1",children:s?(0,l.jsx)("span",{className:"text-red-500 font-bold text-[14px] ",children:"*"}):null})]})}},89076:function(e,t,s){var l=s(57437),a=s(2265),r=s(96473),n=s(54534),i=s(51145),o=s(66789),c=s(40257);let d=e=>new Promise((t,s)=>{let l=new FileReader;l.readAsDataURL(e),l.onload=()=>t(l.result),l.onerror=e=>s(e)});t.Z=e=>{let{maxCount:t,maxSize:s,accept:p,imageList:x,onImageUploadChange:u}=e,[m,h]=(0,a.useState)(!1),[v,f]=(0,a.useState)(""),[j,g]=(0,a.useState)(x),[w,Z]=(0,a.useState)("");(0,a.useEffect)(()=>{g(x),localStorage.getItem("admintoken")&&Z(localStorage.getItem("admintoken"))},[x]);let y=async e=>{e.url||e.preview||(e.preview=await d(e.originFileObj)),f(e.url||e.preview),h(!0)},N=(0,l.jsxs)("button",{style:{border:0,background:"none",display:"flex",alignItems:"center"},type:"button",children:[(0,l.jsx)(r.Z,{}),(0,l.jsx)("div",{style:{marginTop:8}})]}),_={name:"my-file",action:c.env.NEXT_PUBLIC_BASE_URL+"/myapp/admin/cdn/uploadImg",headers:{admintoken:w}};return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsxs)("div",{className:" min-h-[102px]",children:[(0,l.jsx)(i.Z,{accept:p,listType:"picture-card",fileList:j,onPreview:y,onChange:e=>{let{file:t,fileList:s}=e;g(s),"error"===t.status&&n.ZP.error("上传失败");let l=[];s.forEach(e=>{e.success&&l.push(e.name),e.response&&(0===e.response.code?l.push(e.response.data):1===e.response.code&&(n.ZP.error("上传失败："+e.response.msg),e.status="error"))}),u(l)},maxCount:t,..._,children:(null==j?void 0:j.length)>=t?null:N}),v&&(0,l.jsx)(o.Z,{wrapperStyle:{display:"none"},preview:{visible:m,onVisibleChange:e=>h(e),afterOpenChange:e=>!e&&f("")},src:v})]}),(0,l.jsxs)("div",{className:"text-gray-400 text-sm",children:["图片大小",s,"MB以内，最多",t,"张图片"]})]})})}},12701:function(e,t,s){var l=s(57437);s(2265),t.Z=e=>{let{title:t}=e;return(0,l.jsx)("div",{className:"font-bold text-[14px] px-2 my-2",children:t})}},19697:function(e,t,s){var l=s(57437),a=s(2265),r=s(54534),n=s(7065),i=s(48651),o=s(16836),c=s(23496),d=s(79525),p=s(96257),x=s(89076),u=s(30245),m=s(35831),h=s(12701),v=s(30166),f=s(40257);let j=(0,v.default)(()=>Promise.all([s.e(9766),s.e(4070),s.e(7320)]).then(s.bind(s,57320)),{loadableGenerated:{webpack:()=>[57320]},ssr:!1});t.Z=e=>{let{isOpen:t,onRequestClose:s,initialItem:v}=e,[g,w]=(0,a.useState)(v||{}),[Z,y]=(0,a.useState)([]),[N,_]=(0,a.useState)(!1),S=a.useRef(null);(0,a.useEffect)(()=>{var e,t;w(v||{}),(null==v?void 0:null===(e=v.cover)||void 0===e?void 0:e.length)>0?y(null==v?void 0:null===(t=v.cover)||void 0===t?void 0:t.split("#").map(e=>({success:!0,name:e,status:"done",url:f.env.NEXT_PUBLIC_BASE_URL+"/upload/img/"+e}))):y([]),S.current&&(S.current.scrollTop=0)},[v]);let C=(e,t)=>{w(s=>({...s,[e]:t}))},E=async()=>{try{let e=g.id?"/myapp/admin/news/update":"/myapp/admin/news/create",t=new FormData;if(g.id&&t.append("id",g.id),!g.title){r.ZP.error("标题不能为空");return}if(!g.cover){r.ZP.error("封面不能为空");return}t.append("title",g.title||""),t.append("cover",g.cover||""),t.append("source",g.source||""),t.append("description",g.description||""),t.append("seo_title",g.seo_title||""),t.append("seo_keywords",g.seo_keywords||""),t.append("seo_description",g.seo_description||""),_(!0);let{code:l,msg:a,data:n}=await u.Z.post(e,t);0===l?(r.ZP.success("操作成功"),s(!0)):r.ZP.error(a||"网络异常"),_(!1)}catch(e){_(!1)}};return(0,l.jsx)(n.Z,{title:g.id?"编辑":"新增",centered:!0,open:t,onCancel:()=>s(!1),footer:null,width:1100,styles:{mask:{backdropFilter:"blur(10px)"}},children:(0,l.jsx)(i.Z,{spinning:N,tip:"",children:(0,l.jsx)("div",{className:"flex flex-col",children:(0,l.jsx)("div",{ref:S,className:"max-h-[70vh] overflow-y-auto",children:(0,l.jsxs)("div",{className:"",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-4 pt-4 pb-0",children:[(0,l.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,l.jsx)(p.Z,{title:"新闻标题",required:!0}),(0,l.jsx)(o.Z,{placeholder:"请输入标题",value:g.title,onChange:e=>C("title",e.target.value),style:{width:600}})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,l.jsx)(p.Z,{title:"新闻来源"}),(0,l.jsx)(o.Z,{placeholder:"请输入来源",value:g.source,onChange:e=>C("source",e.target.value),style:{width:600}})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,l.jsx)(p.Z,{title:"封面图",required:!0}),(0,l.jsx)(x.Z,{maxCount:1,maxSize:2,accept:"image/*",imageList:Z,onImageUploadChange:e=>{let t=e&&e.length>0?e.join("#"):null;w(e=>({...e,cover:t}))}})]})]}),(0,l.jsx)(c.Z,{}),(0,l.jsx)(h.Z,{title:"新闻详情"}),(0,l.jsx)("div",{className:"flex flex-col gap-4 px-2 py-2",children:(0,l.jsx)(j,{htmlText:g.description,onHtmlResult:e=>{w(t=>({...t,description:e}))}})}),(0,l.jsx)(c.Z,{}),(0,l.jsx)(h.Z,{title:"SEO优化"}),(0,l.jsxs)("div",{className:"flex flex-col gap-4 px-2 py-2",children:[(0,l.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,l.jsx)(p.Z,{title:"SEO标题"}),(0,l.jsx)(o.Z,{placeholder:"请输入SEO标题",value:g.seo_title,onChange:e=>C("seo_title",e.target.value),style:{width:600}})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,l.jsx)(p.Z,{title:"SEO关键词"}),(0,l.jsx)(o.Z,{placeholder:"请输入SEO关键词",value:g.seo_keywords,onChange:e=>C("seo_keywords",e.target.value),style:{width:600}})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,l.jsx)(p.Z,{title:"SEO描述"}),(0,l.jsx)(m.Z,{placeholder:"请输入SEO描述",autoSize:{minRows:3,maxRows:6},showCount:!0,maxLength:200,value:g.seo_description,onChange:e=>C("seo_description",e.target.value),style:{width:600}})]})]}),(0,l.jsx)(c.Z,{}),(0,l.jsxs)("div",{className:"flex flex-row gap-4 justify-start",children:[(0,l.jsx)(d.ZP,{type:"primary",onClick:E,children:"提交"}),(0,l.jsx)(d.ZP,{onClick:()=>s(!1),children:"取消"})]})]})})})})})}},30245:function(e,t,s){var l=s(83464),a=s(40257);let r=l.Z.create({baseURL:a.env.NEXT_PUBLIC_BASE_URL,timeout:15e3,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>{{let t=localStorage.getItem("admintoken");e.headers.ADMINTOKEN=t||""}return e},e=>Promise.reject(e)),r.interceptors.response.use(e=>e.data,e=>{let{response:t}=e;if(t){if(401===t.status||403===t.status){localStorage.removeItem("admintoken"),localStorage.removeItem("username");let e=a.env.NEXT_PUBLIC_BASE_PATH||"";window.location.href=e+"/adminLogin"}return Promise.reject(t.data)}return Promise.reject(e)}),t.Z=r}}]);