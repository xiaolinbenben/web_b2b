"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9697],{96257:function(e,s,t){var l=t(57437);t(2265),s.Z=e=>{let{title:s,required:t,labelWidth:a=80}=e;return(0,l.jsxs)("span",{className:"text-[14px] text-[#777] h-[30px] leading-[30px] flex flex-row items-center",style:{width:"".concat(a,"px")},children:[(0,l.jsxs)("div",{children:[s," "]}),(0,l.jsx)("div",{className:"flex flex-col items-center mx-1",children:t?(0,l.jsx)("span",{className:"text-red-500 font-bold text-[14px] ",children:"*"}):null})]})}},89076:function(e,s,t){var l=t(57437),a=t(2265),r=t(96473),i=t(54534),n=t(51145),o=t(66789);let c=e=>new Promise((s,t)=>{let l=new FileReader;l.readAsDataURL(e),l.onload=()=>s(l.result),l.onerror=e=>t(e)});s.Z=e=>{let{maxCount:s,maxSize:t,accept:d,imageList:p,onImageUploadChange:x}=e,[u,h]=(0,a.useState)(!1),[m,v]=(0,a.useState)(""),[f,j]=(0,a.useState)(p),[g,w]=(0,a.useState)("");(0,a.useEffect)(()=>{j(p),localStorage.getItem("admintoken")&&w(localStorage.getItem("admintoken"))},[p]);let Z=async e=>{e.url||e.preview||(e.preview=await c(e.originFileObj)),v(e.url||e.preview),h(!0)},y=(0,l.jsxs)("button",{style:{border:0,background:"none",display:"flex",alignItems:"center"},type:"button",children:[(0,l.jsx)(r.Z,{}),(0,l.jsx)("div",{style:{marginTop:8}})]});return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,l.jsxs)("div",{className:" min-h-[102px]",children:[(0,l.jsx)(n.Z,{accept:d,listType:"picture-card",fileList:f,onPreview:Z,onChange:e=>{let{file:s,fileList:t}=e;j(t),"error"===s.status&&i.ZP.error("上传失败");let l=[];t.forEach(e=>{e.success&&l.push(e.name),e.response&&(0===e.response.code?l.push(e.response.data):1===e.response.code&&(i.ZP.error("上传失败："+e.response.msg),e.status="error"))}),x(l)},maxCount:s,name:"my-file",action:"https://shop.beisi.tech/myapp/admin/cdn/uploadImg",headers:{admintoken:g},children:(null==f?void 0:f.length)>=s?null:y}),m&&(0,l.jsx)(o.Z,{wrapperStyle:{display:"none"},preview:{visible:u,onVisibleChange:e=>h(e),afterOpenChange:e=>!e&&v("")},src:m})]}),(0,l.jsxs)("div",{className:"text-gray-400 text-sm",children:["图片大小",t,"MB以内，最多",s,"张图片"]})]})})}},12701:function(e,s,t){var l=t(57437);t(2265),s.Z=e=>{let{title:s}=e;return(0,l.jsx)("div",{className:"font-bold text-[14px] px-2 my-2",children:s})}},19697:function(e,s,t){var l=t(57437),a=t(2265),r=t(54534),i=t(7065),n=t(48651),o=t(16836),c=t(23496),d=t(79525),p=t(96257),x=t(89076),u=t(30245),h=t(35831),m=t(12701);let v=(0,t(30166).default)(()=>Promise.all([t.e(9766),t.e(4070),t.e(7320)]).then(t.bind(t,57320)),{loadableGenerated:{webpack:()=>[57320]},ssr:!1});s.Z=e=>{let{isOpen:s,onRequestClose:t,initialItem:f}=e,[j,g]=(0,a.useState)(f||{}),[w,Z]=(0,a.useState)([]),[y,N]=(0,a.useState)(!1),S=a.useRef(null);(0,a.useEffect)(()=>{var e,s;g(f||{}),(null==f?void 0:null===(e=f.cover)||void 0===e?void 0:e.length)>0?Z(null==f?void 0:null===(s=f.cover)||void 0===s?void 0:s.split("#").map(e=>({success:!0,name:e,status:"done",url:"https://shop.beisi.tech/upload/img/"+e}))):Z([]),S.current&&(S.current.scrollTop=0)},[f]);let b=(e,s)=>{g(t=>({...t,[e]:s}))},k=async()=>{try{let e=j.id?"/myapp/admin/news/update":"/myapp/admin/news/create",s=new FormData;if(j.id&&s.append("id",j.id),!j.title){r.ZP.error("标题不能为空");return}if(!j.cover){r.ZP.error("封面不能为空");return}s.append("title",j.title||""),s.append("cover",j.cover||""),s.append("source",j.source||""),s.append("description",j.description||""),s.append("seo_title",j.seo_title||""),s.append("seo_keywords",j.seo_keywords||""),s.append("seo_description",j.seo_description||""),N(!0);let{code:l,msg:a,data:i}=await u.Z.post(e,s);0===l?(r.ZP.success("操作成功"),t(!0)):r.ZP.error(a||"网络异常"),N(!1)}catch(e){N(!1)}};return(0,l.jsx)(i.Z,{title:j.id?"编辑":"新增",centered:!0,open:s,onCancel:()=>t(!1),footer:null,width:1100,styles:{mask:{backdropFilter:"blur(10px)"}},children:(0,l.jsx)(n.Z,{spinning:y,tip:"",children:(0,l.jsx)("div",{className:"flex flex-col",children:(0,l.jsx)("div",{ref:S,className:"max-h-[70vh] overflow-y-auto",children:(0,l.jsxs)("div",{className:"",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-4 pt-4 pb-0",children:[(0,l.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,l.jsx)(p.Z,{title:"新闻标题",required:!0}),(0,l.jsx)(o.Z,{placeholder:"请输入标题",value:j.title,onChange:e=>b("title",e.target.value),style:{width:600}})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,l.jsx)(p.Z,{title:"新闻来源"}),(0,l.jsx)(o.Z,{placeholder:"请输入来源",value:j.source,onChange:e=>b("source",e.target.value),style:{width:600}})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,l.jsx)(p.Z,{title:"封面图",required:!0}),(0,l.jsx)(x.Z,{maxCount:1,maxSize:2,accept:"image/*",imageList:w,onImageUploadChange:e=>{let s=e&&e.length>0?e.join("#"):null;g(e=>({...e,cover:s}))}})]})]}),(0,l.jsx)(c.Z,{}),(0,l.jsx)(m.Z,{title:"新闻详情"}),(0,l.jsx)("div",{className:"flex flex-col gap-4 px-2 py-2",children:(0,l.jsx)(v,{htmlText:j.description,onHtmlResult:e=>{g(s=>({...s,description:e}))}})}),(0,l.jsx)(c.Z,{}),(0,l.jsx)(m.Z,{title:"SEO优化"}),(0,l.jsxs)("div",{className:"flex flex-col gap-4 px-2 py-2",children:[(0,l.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,l.jsx)(p.Z,{title:"SEO标题"}),(0,l.jsx)(o.Z,{placeholder:"请输入SEO标题",value:j.seo_title,onChange:e=>b("seo_title",e.target.value),style:{width:600}})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,l.jsx)(p.Z,{title:"SEO关键词"}),(0,l.jsx)(o.Z,{placeholder:"请输入SEO关键词",value:j.seo_keywords,onChange:e=>b("seo_keywords",e.target.value),style:{width:600}})]}),(0,l.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,l.jsx)(p.Z,{title:"SEO描述"}),(0,l.jsx)(h.Z,{placeholder:"请输入SEO描述",autoSize:{minRows:3,maxRows:6},showCount:!0,maxLength:200,value:j.seo_description,onChange:e=>b("seo_description",e.target.value),style:{width:600}})]})]}),(0,l.jsx)(c.Z,{}),(0,l.jsxs)("div",{className:"flex flex-row gap-4 justify-start",children:[(0,l.jsx)(d.ZP,{type:"primary",onClick:k,children:"提交"}),(0,l.jsx)(d.ZP,{onClick:()=>t(!1),children:"取消"})]})]})})})})})}},30245:function(e,s,t){var l=t(83464);let a="https://shop.beisi.tech".replace(/\/$/,""),r=l.Z.create({baseURL:a||void 0,timeout:15e3,headers:{"Content-Type":"application/json"}});r.interceptors.request.use(e=>{{let s=localStorage.getItem("admintoken");e.headers.ADMINTOKEN=s||""}return e},e=>Promise.reject(e)),r.interceptors.response.use(e=>e.data,e=>{let{response:s}=e;return s?((401===s.status||403===s.status)&&(localStorage.removeItem("admintoken"),localStorage.removeItem("username"),window.location.href="/adminLogin"),Promise.reject(s.data)):Promise.reject(e)}),s.Z=r}}]);