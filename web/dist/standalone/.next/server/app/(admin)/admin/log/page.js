(()=>{var e={};e.id=5925,e.ids=[5925],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},36754:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d}),s(12015),s(8518),s(37505),s(35866);var r=s(23191),a=s(88716),i=s(37922),n=s.n(i),l=s(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["(admin)",{children:["admin",{children:["log",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,12015)),"/app/src/app/(admin)/admin/log/page.jsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,8518)),"/app/src/app/(admin)/admin/layout.jsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,37505)),"/app/src/app/(admin)/layout.jsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}]},{"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/app/src/app/(admin)/admin/log/page.jsx"],p="/(admin)/admin/log/page",x={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(admin)/admin/log/page",pathname:"/admin/log",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},69171:(e,t,s)=>{Promise.resolve().then(s.bind(s,20007))},20007:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var r=s(10326),a=s(17577),i=s(33325),n=s(3204),l=s(74543),o=s(36498),d=s(92121),c=s(19817),p=s(13240),x=s(14125),u=s(25842),m=s(25690);function h(){(0,u.v9)(e=>e.adminSetting),(0,u.I0)();let[e,t]=(0,a.useState)([]),[s,i]=(0,a.useState)(!1),[h,g]=(0,a.useState)([]),[j,v]=(0,a.useState)(""),[f,y]=(0,a.useState)(1),[w,Z]=(0,a.useState)(10),[_,P]=(0,a.useState)(0),S=async(e,s)=>{try{i(!0);let{code:r,total:a,data:n}=await m.Z.get("/myapp/admin/opLog/list",{params:{page:e,pageSize:s,keyword:j}});0===r?(t(n),P(a),y(e),Z(s)):o.ZP.error("数据获取失败"),i(!1)}catch(e){}},[b,k]=(0,a.useState)(null),N=async t=>{try{let{code:s,data:r}=await m.Z.post("/myapp/admin/opLog/delete",{ids:t.join(",")});0===s?(o.ZP.success("删除成功"),t.length===e.length&&f>1?y(f-1):S(f,w)):o.ZP.error("删除失败")}catch(e){}},C=async()=>{try{let{code:e,data:t}=await m.Z.post("/myapp/admin/opLog/deleteAll");0===e?(o.ZP.success("删除成功"),g([]),S(1,w)):o.ZP.error("删除失败")}catch(e){}};return r.jsx(r.Fragment,{children:r.jsx("div",{className:"bg-white",children:r.jsx("div",{children:r.jsx(d.Z,{spinning:s,tip:"",children:(0,r.jsxs)("div",{className:" px-4 py-4 flex flex-col gap-4",children:[r.jsx("div",{className:"flex flex-row gap-4",children:r.jsx(l.Z,{title:"确定清空？",okText:"确定",cancelText:"取消",onConfirm:()=>C(),children:r.jsx(c.ZP,{children:"清空"})})}),r.jsx(p.Z,{columns:[{title:"ID",dataIndex:"id",key:"id",width:"100px",textWrap:"word-break"},{title:"IP",dataIndex:"re_ip",key:"re_ip",width:"120px",textWrap:"word-break",render:e=>r.jsx("div",{children:e})},{title:"请求方式",dataIndex:"re_method",key:"re_method",width:"90px",textWrap:"word-break",render:e=>r.jsx("div",{children:e})},{title:"api接口",dataIndex:"re_url",key:"re_url",width:"240px",textWrap:"word-break",render:e=>r.jsx("div",{children:e})},{title:"耗时(ms)",dataIndex:"access_time",key:"access_time"},{title:"创建时间",dataIndex:"re_time",key:"re_time"},{title:"操作",key:"action",align:"center",render:(e,t)=>r.jsx(n.Z,{size:"middle",children:r.jsx(l.Z,{title:"确定删除？",okText:"确定",cancelText:"取消",onConfirm:()=>N([t.id]),children:r.jsx("a",{className:"text-adminPrimaryColor",children:"删除"})})})}],dataSource:e,size:"middle",rowKey:e=>e.id,pagination:!1,scroll:{x:"max-content"},showSizeChanger:!1}),r.jsx("div",{className:"p-4",children:r.jsx(x.Z,{align:"end",current:f,pageSize:w,showSizeChanger:!1,total:_,showTotal:e=>`共 ${e} 条`,onChange:(e,t)=>{y(e),Z(t)}})})]})})})})})}function g(){let e=[{key:"1",label:"日志管理",children:r.jsx(h,{})}];return r.jsx(r.Fragment,{children:r.jsx("div",{className:"bg-gray-100 px-4 py-4",children:r.jsx("div",{className:"",children:r.jsx(i.Z,{indicator:{size:e=>24,align:"center"},tabBarStyle:{paddingLeft:"20px",outline:"none",fontWeight:"400"},className:"bg-white custom-tab",defaultActiveKey:"1",items:e,onChange:e=>{}})})})})}s(84144)},59076:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(10326);s(17577);let a=({title:e,required:t,labelWidth:s=80})=>(0,r.jsxs)("span",{className:"text-[14px] text-[#777] h-[30px] leading-[30px] flex flex-row items-center",style:{width:`${s}px`},children:[(0,r.jsxs)("div",{children:[e," "]}),r.jsx("div",{className:"flex flex-col items-center mx-1",children:t?r.jsx("span",{className:"text-red-500 font-bold text-[14px] ",children:"*"}):null})]})},58575:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var r=s(10326),a=s(17577),i=s(72380),n=s(36498),l=s(4324),o=s(20797);let d=e=>new Promise((t,s)=>{let r=new FileReader;r.readAsDataURL(e),r.onload=()=>t(r.result),r.onerror=e=>s(e)}),c=({maxCount:e,maxSize:t,accept:s,imageList:c,onImageUploadChange:p})=>{let[x,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(""),[g,j]=(0,a.useState)(c),[v,f]=(0,a.useState)("");(0,a.useEffect)(()=>{j(c),localStorage.getItem("admintoken")&&f(localStorage.getItem("admintoken"))},[c]);let y=async e=>{e.url||e.preview||(e.preview=await d(e.originFileObj)),h(e.url||e.preview),u(!0)},w=(0,r.jsxs)("button",{style:{border:0,background:"none",display:"flex",alignItems:"center"},type:"button",children:[r.jsx(i.Z,{}),r.jsx("div",{style:{marginTop:8}})]}),Z={name:"my-file",action:process.env.NEXT_PUBLIC_BASE_URL+"/myapp/admin/cdn/uploadImg",headers:{admintoken:v}};return r.jsx(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:" min-h-[102px]",children:[r.jsx(l.Z,{accept:s,listType:"picture-card",fileList:g,onPreview:y,onChange:({file:e,fileList:t})=>{j(t),"error"===e.status&&n.ZP.error("上传失败");let s=[];t.forEach(e=>{e.success&&s.push(e.name),e.response&&(0===e.response.code?s.push(e.response.data):1===e.response.code&&(n.ZP.error("上传失败："+e.response.msg),e.status="error"))}),p(s)},maxCount:e,...Z,children:g?.length>=e?null:w}),m&&r.jsx(o.Z,{wrapperStyle:{display:"none"},preview:{visible:x,onVisibleChange:e=>u(e),afterOpenChange:e=>!e&&h("")},src:m})]}),(0,r.jsxs)("div",{className:"text-gray-400 text-sm",children:["图片大小",t,"MB以内，最多",e,"张图片"]})]})})}},40240:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(10326);s(17577);let a=({title:e})=>r.jsx("div",{className:"font-bold text-[14px] px-2 my-2",children:e})},84144:(e,t,s)=>{"use strict";s.d(t,{Z:()=>v});var r=s(10326),a=s(17577),i=s.n(a),n=s(36498),l=s(77814),o=s(92121),d=s(16039),c=s(276),p=s(19817),x=s(59076),u=s(58575),m=s(25690),h=s(12341),g=s(40240);let j=(0,s(33265).default)(async()=>{},{loadableGenerated:{modules:["components/admin/news/newsModal.jsx -> /src/components/admin/wangEditor.jsx"]},ssr:!1}),v=({isOpen:e,onRequestClose:t,initialItem:s})=>{let[v,f]=(0,a.useState)(s||{}),[y,w]=(0,a.useState)([]),[Z,_]=(0,a.useState)(!1),P=i().useRef(null);(0,a.useEffect)(()=>{f(s||{}),s?.cover?.length>0?w(s?.cover?.split("#").map(e=>({success:!0,name:e,status:"done",url:process.env.NEXT_PUBLIC_BASE_URL+"/upload/img/"+e}))):w([]),P.current&&(P.current.scrollTop=0)},[s]);let S=(e,t)=>{f(s=>({...s,[e]:t}))},b=async()=>{try{let e=v.id?"/myapp/admin/news/update":"/myapp/admin/news/create",s=new FormData;if(v.id&&s.append("id",v.id),!v.title){n.ZP.error("标题不能为空");return}if(!v.cover){n.ZP.error("封面不能为空");return}s.append("title",v.title||""),s.append("cover",v.cover||""),s.append("source",v.source||""),s.append("description",v.description||""),s.append("seo_title",v.seo_title||""),s.append("seo_keywords",v.seo_keywords||""),s.append("seo_description",v.seo_description||""),_(!0);let{code:r,msg:a,data:i}=await m.Z.post(e,s);0===r?(n.ZP.success("操作成功"),t(!0)):n.ZP.error(a||"网络异常"),_(!1)}catch(e){_(!1)}};return r.jsx(l.Z,{title:v.id?"编辑":"新增",centered:!0,open:e,onCancel:()=>t(!1),footer:null,width:1100,styles:{mask:{backdropFilter:"blur(10px)"}},children:r.jsx(o.Z,{spinning:Z,tip:"",children:r.jsx("div",{className:"flex flex-col",children:r.jsx("div",{ref:P,className:"max-h-[70vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4 pt-4 pb-0",children:[(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[r.jsx(x.Z,{title:"新闻标题",required:!0}),r.jsx(d.Z,{placeholder:"请输入标题",value:v.title,onChange:e=>S("title",e.target.value),style:{width:600}})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[r.jsx(x.Z,{title:"新闻来源"}),r.jsx(d.Z,{placeholder:"请输入来源",value:v.source,onChange:e=>S("source",e.target.value),style:{width:600}})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[r.jsx(x.Z,{title:"封面图",required:!0}),r.jsx(u.Z,{maxCount:1,maxSize:2,accept:"image/*",imageList:y,onImageUploadChange:e=>{let t=e&&e.length>0?e.join("#"):null;f(e=>({...e,cover:t}))}})]})]}),r.jsx(c.Z,{}),r.jsx(g.Z,{title:"新闻详情"}),r.jsx("div",{className:"flex flex-col gap-4 px-2 py-2",children:r.jsx(j,{htmlText:v.description,onHtmlResult:e=>{f(t=>({...t,description:e}))}})}),r.jsx(c.Z,{}),r.jsx(g.Z,{title:"SEO优化"}),(0,r.jsxs)("div",{className:"flex flex-col gap-4 px-2 py-2",children:[(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[r.jsx(x.Z,{title:"SEO标题"}),r.jsx(d.Z,{placeholder:"请输入SEO标题",value:v.seo_title,onChange:e=>S("seo_title",e.target.value),style:{width:600}})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[r.jsx(x.Z,{title:"SEO关键词"}),r.jsx(d.Z,{placeholder:"请输入SEO关键词",value:v.seo_keywords,onChange:e=>S("seo_keywords",e.target.value),style:{width:600}})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[r.jsx(x.Z,{title:"SEO描述"}),r.jsx(h.Z,{placeholder:"请输入SEO描述",autoSize:{minRows:3,maxRows:6},showCount:!0,maxLength:200,value:v.seo_description,onChange:e=>S("seo_description",e.target.value),style:{width:600}})]})]}),r.jsx(c.Z,{}),(0,r.jsxs)("div",{className:"flex flex-row gap-4 justify-start",children:[r.jsx(p.ZP,{type:"primary",onClick:b,children:"提交"}),r.jsx(p.ZP,{onClick:()=>t(!1),children:"取消"})]})]})})})})})}},12015:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(68570).createProxy)(String.raw`/app/src/app/(admin)/admin/log/page.jsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[5819,555,280,9921,8365,6498,9376,6742,5899,6039,5782,7832,6077,4605,8147],()=>s(36754));module.exports=r})();