(()=>{var e={};e.id=3288,e.ids=[3288],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},92838:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d}),s(27067),s(8518),s(37505),s(35866);var r=s(23191),a=s(88716),i=s(37922),n=s.n(i),l=s(95231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["(admin)",{children:["admin",{children:["news",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,27067)),"/app/src/app/(admin)/admin/news/page.jsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,8518)),"/app/src/app/(admin)/admin/layout.jsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,37505)),"/app/src/app/(admin)/layout.jsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}]},{"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/app/src/app/(admin)/admin/news/page.jsx"],p="/(admin)/admin/news/page",x={require:s,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(admin)/admin/news/page",pathname:"/admin/news",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},80809:(e,t,s)=>{Promise.resolve().then(s.bind(s,60194))},60194:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var r=s(10326),a=s(17577),i=s(33325),n=s(3204),l=s(74543),o=s(36498),d=s(92121),c=s(19817),p=s(13240),x=s(14125),u=s(25842),m=s(52401),h=s(25690),g=s(84144);function j(){(0,u.v9)(e=>e.adminSetting),(0,u.I0)();let[e,t]=(0,a.useState)([]),[s,i]=(0,a.useState)(!1),[j,f]=(0,a.useState)([]),[v,y]=(0,a.useState)(""),[w,Z]=(0,a.useState)(1),[S,P]=(0,a.useState)(10),[_,b]=(0,a.useState)(0),C=async(e,s)=>{try{i(!0);let{code:r,total:a,data:n}=await h.Z.get("/myapp/admin/news/list",{params:{page:e,pageSize:s,keyword:v}});0===r?(t(n),b(a),Z(e),P(s)):o.ZP.error("数据获取失败"),i(!1)}catch(e){}},[N,k]=(0,a.useState)(!1),[q,E]=(0,a.useState)(null),I=e=>{k(!0),E(e)},T=async t=>{try{let{code:s,data:r}=await h.Z.post("/myapp/admin/news/delete",{ids:t.join(",")});0===s?(o.ZP.success("删除成功"),t.length===e.length&&w>1?Z(w-1):C(w,S)):o.ZP.error("删除失败")}catch(e){}};return(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"bg-white",children:r.jsx("div",{children:r.jsx(d.Z,{spinning:s,tip:"",children:(0,r.jsxs)("div",{className:" px-4 py-4 flex flex-col gap-4",children:[(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[r.jsx(c.ZP,{type:"primary",onClick:()=>I({sort:0}),children:"新增"}),r.jsx(l.Z,{title:"确定删除？",okText:"确定",cancelText:"取消",onConfirm:()=>T(j),children:r.jsx(c.ZP,{disabled:!j.length>0,children:"删除"})}),r.jsx(m.Z,{placeholder:"搜索",allowClear:!0,onSearch:(e,t,s)=>{Z(1),y(e||"")},style:{width:200,marginLeft:"auto"}})]}),r.jsx(p.Z,{columns:[{title:"标题",dataIndex:"title",key:"title",width:"320px",textWrap:"word-break"},{title:"来源",dataIndex:"source",key:"source"},{title:"创建时间",dataIndex:"create_time",key:"create_time"},{title:"操作",key:"action",align:"center",render:(e,t)=>(0,r.jsxs)(n.Z,{size:"middle",children:[r.jsx("a",{className:"text-adminPrimaryColor",onClick:()=>I(t),children:"编辑"}),r.jsx(l.Z,{title:"确定删除？",okText:"确定",cancelText:"取消",onConfirm:()=>T([t.id]),children:r.jsx("a",{className:"text-adminPrimaryColor",children:"删除"})})]})}],dataSource:e,size:"middle",rowSelection:{selectedRowKeys:j,onChange:e=>{f(e)}},rowKey:e=>e.id,pagination:!1,scroll:{x:"max-content"},showSizeChanger:!1}),r.jsx("div",{className:"p-4",children:r.jsx(x.Z,{align:"end",current:w,pageSize:S,total:_,showTotal:e=>`共 ${e} 条`,onChange:(e,t)=>{Z(e),P(t)}})})]})})})}),r.jsx(g.Z,{isOpen:N,onRequestClose:e=>{k(!1),E(null),e&&C(w,S)},initialItem:q})]})}function f(){let e=[{key:"1",label:"新闻列表",children:r.jsx(j,{})}];return r.jsx(r.Fragment,{children:r.jsx("div",{className:"bg-gray-100 px-4 py-4",children:r.jsx("div",{className:"",children:r.jsx(i.Z,{indicator:{size:e=>24,align:"center"},tabBarStyle:{paddingLeft:"20px",outline:"none",fontWeight:"400"},className:"bg-white custom-tab",defaultActiveKey:"1",items:e,onChange:e=>{}})})})})}},59076:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(10326);s(17577);let a=({title:e,required:t,labelWidth:s=80})=>(0,r.jsxs)("span",{className:"text-[14px] text-[#777] h-[30px] leading-[30px] flex flex-row items-center",style:{width:`${s}px`},children:[(0,r.jsxs)("div",{children:[e," "]}),r.jsx("div",{className:"flex flex-col items-center mx-1",children:t?r.jsx("span",{className:"text-red-500 font-bold text-[14px] ",children:"*"}):null})]})},58575:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var r=s(10326),a=s(17577),i=s(72380),n=s(36498),l=s(4324),o=s(20797);let d=e=>new Promise((t,s)=>{let r=new FileReader;r.readAsDataURL(e),r.onload=()=>t(r.result),r.onerror=e=>s(e)}),c=({maxCount:e,maxSize:t,accept:s,imageList:c,onImageUploadChange:p})=>{let[x,u]=(0,a.useState)(!1),[m,h]=(0,a.useState)(""),[g,j]=(0,a.useState)(c),[f,v]=(0,a.useState)("");(0,a.useEffect)(()=>{j(c),localStorage.getItem("admintoken")&&v(localStorage.getItem("admintoken"))},[c]);let y=async e=>{e.url||e.preview||(e.preview=await d(e.originFileObj)),h(e.url||e.preview),u(!0)},w=(0,r.jsxs)("button",{style:{border:0,background:"none",display:"flex",alignItems:"center"},type:"button",children:[r.jsx(i.Z,{}),r.jsx("div",{style:{marginTop:8}})]}),Z={name:"my-file",action:process.env.NEXT_PUBLIC_BASE_URL+"/myapp/admin/cdn/uploadImg",headers:{admintoken:f}};return r.jsx(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:" min-h-[102px]",children:[r.jsx(l.Z,{accept:s,listType:"picture-card",fileList:g,onPreview:y,onChange:({file:e,fileList:t})=>{j(t),"error"===e.status&&n.ZP.error("上传失败");let s=[];t.forEach(e=>{e.success&&s.push(e.name),e.response&&(0===e.response.code?s.push(e.response.data):1===e.response.code&&(n.ZP.error("上传失败："+e.response.msg),e.status="error"))}),p(s)},maxCount:e,...Z,children:g?.length>=e?null:w}),m&&r.jsx(o.Z,{wrapperStyle:{display:"none"},preview:{visible:x,onVisibleChange:e=>u(e),afterOpenChange:e=>!e&&h("")},src:m})]}),(0,r.jsxs)("div",{className:"text-gray-400 text-sm",children:["图片大小",t,"MB以内，最多",e,"张图片"]})]})})}},40240:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var r=s(10326);s(17577);let a=({title:e})=>r.jsx("div",{className:"font-bold text-[14px] px-2 my-2",children:e})},84144:(e,t,s)=>{"use strict";s.d(t,{Z:()=>f});var r=s(10326),a=s(17577),i=s.n(a),n=s(36498),l=s(77814),o=s(92121),d=s(16039),c=s(276),p=s(19817),x=s(59076),u=s(58575),m=s(25690),h=s(12341),g=s(40240);let j=(0,s(33265).default)(async()=>{},{loadableGenerated:{modules:["components/admin/news/newsModal.jsx -> /src/components/admin/wangEditor.jsx"]},ssr:!1}),f=({isOpen:e,onRequestClose:t,initialItem:s})=>{let[f,v]=(0,a.useState)(s||{}),[y,w]=(0,a.useState)([]),[Z,S]=(0,a.useState)(!1),P=i().useRef(null);(0,a.useEffect)(()=>{v(s||{}),s?.cover?.length>0?w(s?.cover?.split("#").map(e=>({success:!0,name:e,status:"done",url:process.env.NEXT_PUBLIC_BASE_URL+"/upload/img/"+e}))):w([]),P.current&&(P.current.scrollTop=0)},[s]);let _=(e,t)=>{v(s=>({...s,[e]:t}))},b=async()=>{try{let e=f.id?"/myapp/admin/news/update":"/myapp/admin/news/create",s=new FormData;if(f.id&&s.append("id",f.id),!f.title){n.ZP.error("标题不能为空");return}if(!f.cover){n.ZP.error("封面不能为空");return}s.append("title",f.title||""),s.append("cover",f.cover||""),s.append("source",f.source||""),s.append("description",f.description||""),s.append("seo_title",f.seo_title||""),s.append("seo_keywords",f.seo_keywords||""),s.append("seo_description",f.seo_description||""),S(!0);let{code:r,msg:a,data:i}=await m.Z.post(e,s);0===r?(n.ZP.success("操作成功"),t(!0)):n.ZP.error(a||"网络异常"),S(!1)}catch(e){S(!1)}};return r.jsx(l.Z,{title:f.id?"编辑":"新增",centered:!0,open:e,onCancel:()=>t(!1),footer:null,width:1100,styles:{mask:{backdropFilter:"blur(10px)"}},children:r.jsx(o.Z,{spinning:Z,tip:"",children:r.jsx("div",{className:"flex flex-col",children:r.jsx("div",{ref:P,className:"max-h-[70vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4 pt-4 pb-0",children:[(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[r.jsx(x.Z,{title:"新闻标题",required:!0}),r.jsx(d.Z,{placeholder:"请输入标题",value:f.title,onChange:e=>_("title",e.target.value),style:{width:600}})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[r.jsx(x.Z,{title:"新闻来源"}),r.jsx(d.Z,{placeholder:"请输入来源",value:f.source,onChange:e=>_("source",e.target.value),style:{width:600}})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[r.jsx(x.Z,{title:"封面图",required:!0}),r.jsx(u.Z,{maxCount:1,maxSize:2,accept:"image/*",imageList:y,onImageUploadChange:e=>{let t=e&&e.length>0?e.join("#"):null;v(e=>({...e,cover:t}))}})]})]}),r.jsx(c.Z,{}),r.jsx(g.Z,{title:"新闻详情"}),r.jsx("div",{className:"flex flex-col gap-4 px-2 py-2",children:r.jsx(j,{htmlText:f.description,onHtmlResult:e=>{v(t=>({...t,description:e}))}})}),r.jsx(c.Z,{}),r.jsx(g.Z,{title:"SEO优化"}),(0,r.jsxs)("div",{className:"flex flex-col gap-4 px-2 py-2",children:[(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[r.jsx(x.Z,{title:"SEO标题"}),r.jsx(d.Z,{placeholder:"请输入SEO标题",value:f.seo_title,onChange:e=>_("seo_title",e.target.value),style:{width:600}})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[r.jsx(x.Z,{title:"SEO关键词"}),r.jsx(d.Z,{placeholder:"请输入SEO关键词",value:f.seo_keywords,onChange:e=>_("seo_keywords",e.target.value),style:{width:600}})]}),(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[r.jsx(x.Z,{title:"SEO描述"}),r.jsx(h.Z,{placeholder:"请输入SEO描述",autoSize:{minRows:3,maxRows:6},showCount:!0,maxLength:200,value:f.seo_description,onChange:e=>_("seo_description",e.target.value),style:{width:600}})]})]}),r.jsx(c.Z,{}),(0,r.jsxs)("div",{className:"flex flex-row gap-4 justify-start",children:[r.jsx(p.ZP,{type:"primary",onClick:b,children:"提交"}),r.jsx(p.ZP,{onClick:()=>t(!1),children:"取消"})]})]})})})})})}},27067:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(68570).createProxy)(String.raw`/app/src/app/(admin)/admin/news/page.jsx#default`)}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[5819,555,280,9921,8365,6498,9376,6742,5899,6039,5782,7832,6077,4605,8147],()=>s(92838));module.exports=r})();